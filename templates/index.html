<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Prediksi MLOps untuk Pasar Listrik Finlandia</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="preconnect" href="[https://fonts.googleapis.com](https://fonts.googleapis.com)">
    <link rel="preconnect" href="[https://fonts.gstatic.com](https://fonts.gstatic.com)" crossorigin>
    <link href="[https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap](https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap)" rel="stylesheet">
</head>
<body>
    <header>
        <h1>Dashboard Prediksi MLOps</h1>
        <p>Studi Kasus: Pasar Listrik Finlandia</p>
    </header>

    <main class="dashboard-container">
        <!-- Visualisasi 1: Prediksi -->
        <section class="dashboard-card">
            <h2>Prediksi Harga Listrik</h2>
            {% if plot_forecast_only %}
            <img src="data:image/png;base64,{{ plot_forecast_only }}" alt="Prediksi">
            {% else %}
            <p>Data prediksi</p>
            {% endif %}
            <p class="card-description">Visual ini melihat harga biaya pasar listrik pada beberapa jam selanjutnya</p>
        </section>

        <!-- Visualisasi 2: Tren MAE Model -->
        <section class="dashboard-card">
            <h2>Tren Error MAE Setelah Model {{ model_name }} di Implementasi</h2>
            {% if plot_mae_trend %}
            <img src="data:image/png;base64,{{ plot_mae_trend }}" alt="Tren MAE">
            {% else %}
            <p>Data tren MAE model tidak tersedia.</p>
            {% endif %}
            <p class="card-description">Melihat tren Mean Absolute Error (MAE) dari setiap pelatihan ulang model memberikan gambaran kualitas yang meningkat atau menurun</p>
        </section>

        <!-- Visualisasi 3: Waktu Penyelesaian Pipeline -->
        <section class="dashboard-card">
            <h2>Waktu Penyelesaian Pipeline ML</h2>
            {% if plot_pipeline_timings %}
            <img src="data:image/png;base64,{{ plot_pipeline_timings }}" alt="Waktu Pipeline">
            {% else %}
            <p>Data waktu penyelesaian pipeline tidak tersedia.</p>
            {% endif %}
            <p class="card-description">Memantau durasi eksekusi setiap pipeline ML yang dijalankan untuk memastikan prediksi dapat ter-deploy tepat waktu</p>
        </section>

        <!-- Prediction Trigger Butto -->
        <section class="dashboard-card" style="margin-top: 40px; text-align: center; clear: both;">
            <h2>Buat prediksi baru</h2>
            <button id="predict-button" onclick="triggerPrediction()"
                    style="background-color: #007BFF; color: white; padding: 14px 28px; font-size: 16px; border: none; border-radius: 6px; cursor: pointer;">
                Jalankan prediksi
            </button>
            <p id="predict-status" style="margin-top: 10px; color: #333; font-weight: 500;"></p>
        </section>

        <script>
        function triggerPrediction() {
            const statusElement = document.getElementById('predict-status');
            statusElement.textContent = 'Prediksi sedang berjalan hingga 20 menit ke depan';

            fetch('/predict', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({})  // Add feature payload here later
            })
            .then(response => response.json())
            .then(data => {
                statusElement.textContent = data.message || 'Prediksi selesai';
            })
            .catch(error => {
                statusElement.textContent = 'Eror hasil prediksi: ' + error;
            });
        }
        </script>

    </main>

    <footer>
        <p>&copy; 2025 Proyek MLOps. Semua Hak Dilindungi.</p>
    </footer>
</body>
</html>
